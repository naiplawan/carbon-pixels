/* Font CSS import moved to layout.tsx for better loading performance */
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --paper: 48 20% 97%;
    --ink: 222.2 47% 11%;
    --pencil: 217.2 32.6% 17.5%;
  }

  * {
    @apply border-gray-300;
  }
  
  body {
    @apply bg-paper text-ink font-handwritten;
    background-image: 
      radial-gradient(circle at 1px 1px, rgba(45, 55, 72, 0.08) 1px, transparent 0);
    background-size: 20px 20px;
  }
}

@layer components {
  .notebook-page {
    @apply bg-paper border-l-4 border-red-300 pl-4 md:pl-8 min-h-screen;
    background-image: 
      linear-gradient(90deg, rgba(239, 68, 68, 0.2) 1px, transparent 1px),
      linear-gradient(rgba(156, 163, 175, 0.2) 1px, transparent 1px);
    background-size: 2rem 2rem, 100% 2rem;
  }

  .handwritten-text {
    @apply font-handwritten text-ink;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
  }

  .sketch-element {
    filter: 
      drop-shadow(1px 1px 1px rgba(0, 0, 0, 0.1))
      drop-shadow(-1px -1px 1px rgba(255, 255, 255, 0.5));
  }

  /* Accessibility improvements */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  .focus-visible {
    @apply outline-none ring-2 ring-offset-2 ring-green-500;
  }

  /* Button accessibility */
  button:focus-visible,
  a:focus-visible {
    @apply outline-none ring-2 ring-offset-2 ring-green-500 ring-opacity-75;
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .notebook-page {
      background-image: none;
      @apply border-l-8 border-black;
    }
    
    .handwritten-text,
    .text-ink {
      @apply text-black;
    }
    
    .text-pencil {
      @apply text-gray-800;
    }
  }

  /* Reduced motion support */
  @media (prefers-reduced-motion: reduce) {
    .animate-draw,
    .animate-fade-in {
      animation: none;
    }
    
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* Mobile performance optimizations */
  @media (max-width: 768px) {
    /* Reduce repaints on mobile */
    .notebook-page {
      background-attachment: scroll;
    }
    
    /* Optimize touch interactions */
    .sketch-element {
      transform: translateZ(0); /* Hardware acceleration */
      will-change: transform; /* Prepare for animations */
    }
    
    /* Reduce shadow complexity on mobile */
    .handwritten-text {
      text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);
    }
    
    /* Optimize gradients for mobile GPUs */
    .bg-gradient-to-r {
      background-size: 200% 100%;
      background-position: 0% 0%;
    }
  }

  /* Performance hints for browsers */
  .modal-backdrop {
    contain: layout style paint;
    will-change: opacity;
  }
  
  .scanner-camera {
    contain: layout style paint size;
    transform: translateZ(0);
  }

  /* Dark mode support with performance considerations */
  @media (prefers-color-scheme: dark) {
    .notebook-page {
      @apply bg-gray-900 text-gray-100;
      background-image: 
        linear-gradient(90deg, rgba(239, 68, 68, 0.3) 1px, transparent 1px),
        linear-gradient(rgba(156, 163, 175, 0.3) 1px, transparent 1px);
    }
    
    .text-ink {
      @apply text-gray-100;
    }
    
    .text-pencil {
      @apply text-gray-300;
    }
    
    .bg-white\/70 {
      @apply bg-gray-800/70;
    }
  }

  /* Critical rendering path optimization */
  .above-fold {
    contain: layout style;
  }
  
  .below-fold {
    content-visibility: auto;
    contain-intrinsic-size: 300px;
  }
}